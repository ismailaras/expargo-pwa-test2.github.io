function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{QZQ5:function(e,t,n){"use strict";n.r(t),n.d(t,"BasketsPageModule",(function(){return K}));var i=n("ofXK"),o=n("3Pt+"),r=n("TEn/"),a=n("tyNb"),s=n("mrSG"),c=n("dvAk"),l=n("i0fx"),b=n("FFM/"),u=n("AxNX"),f=n("Mky/"),h=n("fXoL"),d=n("7BcZ"),g=n("qfBg"),m=n("ndxW"),p=n("Nm8O"),k=n("Ymxs"),y=n("e8h1");function v(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-toolbar",1),h.Pb(1,"ion-searchbar",9),h.Xb("ngModelChange",(function(e){return h.oc(n),h.Zb().keyword=e}))("ionChange",(function(){return h.oc(n),h.Zb().search()})),h.Ob(),h.Ob()}if(2&e){var i=h.Zb();h.yb(1),h.gc("ngModel",i.keyword)}}function O(e,t){if(1&e&&(h.Pb(0,"ion-select-option",16),h.vc(1),h.Ob()),2&e){var n=t.$implicit,i=t.index,o=h.Zb(3);h.gc("value",i),h.yb(1),h.xc(" ",o.stateService.getOrderStateInAzerbaijani(n)," ")}}function P(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-item",14),h.Pb(1,"ion-label"),h.vc(2,"Filtr"),h.Ob(),h.Pb(3,"ion-select",15),h.Xb("ngModelChange",(function(e){return h.oc(n),h.Zb(2).filterKey=e}))("ionChange",(function(){return h.oc(n),h.Zb(2).filterBaskets()})),h.Pb(4,"ion-select-option",16),h.vc(5," Filtr se\xe7ilm\u0259yib "),h.Ob(),h.tc(6,O,2,2,"ion-select-option",17),h.ac(7,"slice"),h.Ob(),h.Ob()}if(2&e){var i=h.Zb(2);h.yb(3),h.gc("ngModel",i.filterKey),h.yb(1),h.gc("value","none"),h.yb(2),h.gc("ngForOf",h.cc(7,3,i.basketStateData,0))}}function x(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-item-option",31),h.Xb("click",(function(){h.oc(n);var e=h.Zb().$implicit;return h.Zb(3).pay([e])})),h.Kb(1,"ion-icon",32),h.Pb(2,"ion-label"),h.vc(3," \xd6d\u0259 "),h.Ob(),h.Ob()}}function w(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-col",19),h.Pb(1,"ion-item-sliding"),h.Pb(2,"ion-item",20),h.Pb(3,"ion-thumbnail",2),h.Kb(4,"ion-img",21),h.Ob(),h.Pb(5,"ion-label",22),h.Pb(6,"ion-text",23),h.Pb(7,"h3"),h.vc(8),h.Ob(),h.Ob(),h.Pb(9,"ion-text",24),h.Pb(10,"p"),h.vc(11),h.Ob(),h.Ob(),h.Ob(),h.Ob(),h.Pb(12,"ion-item-options",25),h.Pb(13,"ion-item-option",26),h.Xb("click",(function(){h.oc(n);var e=t.$implicit;return h.Zb(3).goUrl(e)})),h.Kb(14,"ion-icon",27),h.Pb(15,"ion-label"),h.vc(16," URL "),h.Ob(),h.Ob(),h.tc(17,x,4,0,"ion-item-option",28),h.Pb(18,"ion-item-option",29),h.Xb("click",(function(){h.oc(n);var e=t.$implicit;return h.Zb(3).presentTrackingModal(e)})),h.Kb(19,"ion-icon",30),h.Pb(20,"ion-label"),h.vc(21," \u0130zl\u0259 "),h.Ob(),h.Ob(),h.Ob(),h.Ob(),h.Ob()}if(2&e){var i=t.$implicit,o=t.index,r=h.Zb(3);h.yb(2),h.ic("routerLink","/dashboard/baskets/basket/",i.id,""),h.gc("color",r.platform.is("mobile")&&o%2!=0?"light":null)("lines",r.platform.is("mobile")?"none":null),h.yb(2),h.gc("src","/assets/img/baskets_thumbnail.png"),h.yb(4),h.wc(i.id),h.yb(3),h.xc(" ",r.stateService.getOrderStateInAzerbaijani(i.current_state.toString())," "),h.yb(6),h.gc("ngIf","Incomplete"===i.current_state.toString())}}function C(e,t){if(1&e&&(h.Pb(0,"ion-grid"),h.Pb(1,"ion-row"),h.tc(2,w,22,7,"ion-col",18),h.Ob(),h.Ob()),2&e){var n=h.Zb(2);h.yb(2),h.gc("ngForOf",n.baskets)}}function _(e,t){1&e&&(h.Pb(0,"ion-card",33),h.Pb(1,"ion-card-content"),h.vc(2," He\xe7 bir s\u0259b\u0259t tap\u0131lmad\u0131. "),h.Ob(),h.Ob())}function B(e,t){if(1&e){var n=h.Qb();h.Pb(0,"ion-content"),h.Pb(1,"ion-refresher",10),h.Xb("ionRefresh",(function(){return h.oc(n),h.Zb().doRefresh()})),h.Kb(2,"ion-refresher-content"),h.Ob(),h.tc(3,P,8,6,"ion-item",11),h.tc(4,C,3,1,"ion-grid",12),h.tc(5,_,3,0,"ng-template",null,13,h.uc),h.Ob()}if(2&e){var i=h.mc(6),o=h.Zb();h.yb(3),h.gc("ngIf",o.isFilterActive),h.yb(1),h.gc("ngIf",o.baskets.length>0)("ngIfElse",i)}}function S(e,t){1&e&&(h.Pb(0,"ion-content"),h.Pb(1,"ion-grid",34),h.Pb(2,"ion-row",35),h.Pb(3,"ion-col",36),h.Kb(4,"ion-img",37),h.Ob(),h.Ob(),h.Ob(),h.Ob())}var M,Z,A,I=[{path:"",component:(M=function(){function e(t,n,i,o,r,a,s,c,l){_classCallCheck(this,e),this.basketService=t,this.platform=n,this.userService=i,this.stateService=o,this.alertCtrl=r,this.helper=a,this.toaster=s,this.modalController=c,this.storage=l,this.isFilterActive=!0,this.isSearchActive=!1,this.baskets=[],this.isLoading=!1,this.filterKey="none",this.missing_fee=0,this.user=new f.a}return _createClass(e,[{key:"ionViewWillEnter",value:function(){this.getBaskets()}},{key:"ngOnInit",value:function(){}},{key:"presentTrackingModal",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:b.a,swipeToClose:!0,componentProps:{states:e.states}});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"showAlert",value:function(e){this.alertCtrl.create({header:"X\u0259ta a\u015fkarland\u0131",message:e,buttons:["Tamam"]}).then((function(e){return e.present()}))}},{key:"getBaskets",value:function(){var e=this;this.storage.get("user").then((function(t){e.user=t,e.baskets=t.baskets}))}},{key:"filterBaskets",value:function(){var e=this;this.isLoading=!0,this.storage.get("access_token").then((function(t){e.basketService.getBaskets(e.user.id).subscribe((function(t){e.user.baskets=t,e.storage.set("user",e.user).then((function(n){e.baskets="none"!==e.filterKey?t.filter((function(t){return l.a[t.current_state.toString()]===Number(e.filterKey)})):t,e.isLoading=!1}))}),(function(t){e.isLoading=!1,404!==t.status&&e.showAlert("Bilinm\u0259y\u0259n bir x\u0259ta ba\u015f verdi. Z\u0259hm\u0259t olmasa, daha sonra t\u0259krar yoxlay\u0131n.")}))}))}},{key:"doRefresh",value:function(){this.filterBaskets()}},{key:"search",value:function(){}},{key:"presentCheckoutModal",value:function(e,t){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:u.a,swipeToClose:!0,cssClass:"checkoutModal",componentProps:{missing_fee:e,currency:t}});case 2:return i=n.sent,n.next=5,i.present();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"showConfirm",value:function(e,t){var n=this;this.alertCtrl.create({header:"\xd6d\u0259ni\u015f et",message:e,buttons:[{text:"L\u0259v\u011f et",role:"cancel"},{text:"Balans art\u0131r",handler:function(){n.presentCheckoutModal(n.missing_fee,"USD").then((function(e){return console.log(e)}))}},{text:"Tamamla",handler:function(){n.completePayment(t)}}]}).then((function(e){return e.present()}))}},{key:"pay",value:function(e){var t=e.filter((function(e){return"Incomplete"===e.current_state.toString()}));this.getBasketsAmount(t),0!==this.missing_fee?this.showConfirm("\n                            Hal-haz\u0131rk\u0131 balans: \u20ba".concat(this.user.wallet_usd.toFixed(2),"<br>\n                            Natamam m\u0259bl\u0259\u011f: \u20ba").concat(this.missing_fee.toFixed(2),"<br>\n                            <hr>\n                            <small>Balans\u0131n\u0131zda kifay\u0259t q\u0259d\u0259r v\u0259sait yoxdursa, z\u0259hm\u0259t olmasa, balans art\u0131r d\xfcym\u0259sini s\u0131x\u0131n.</small>\n                        "),t):this.showAlert("Natamam \xf6d\u0259ni\u015fli s\u0259b\u0259t tap\u0131lmad\u0131.")}},{key:"getBasketsAmount",value:function(e){var t=this;this.missing_fee=0,e.forEach((function(e){return t.missing_fee+=e.missing_fee}))}},{key:"completePayment",value:function(e){var t=this;this.basketService.setBasketsToReadyToOrder(e,this.missing_fee,this.user.id).subscribe((function(e){"User's wallet is not enough for payment."===JSON.parse(e).message?t.toaster.danger("Balans\u0131n\u0131zda kifay\u0259t q\u0259d\u0259r v\u0259sait yoxdur."):(t.filterBaskets(),t.toaster.success("\xd6d\u0259ni\u015finiz u\u011furla ba\u015fa \xe7atd\u0131."))}),(function(e){t.showAlert("Bilinm\u0259y\u0259n bir x\u0259ta ba\u015f verdi. Z\u0259hm\u0259t olmasa, daha sonra t\u0259krar yoxlay\u0131n.")}))}},{key:"goUrl",value:function(e){window.open(e.shop_url,"_blank")}},{key:"productCategoryData",get:function(){return Object.keys(c.a).filter((function(e){return!isNaN(Number(c.a[e]))}))}},{key:"basketStateData",get:function(){return Object.keys(l.a).filter((function(e){return!isNaN(Number(l.a[e]))}))}}]),e}(),M.\u0275fac=function(e){return new(e||M)(h.Jb(d.a),h.Jb(r.hb),h.Jb(g.a),h.Jb(m.a),h.Jb(r.a),h.Jb(p.b),h.Jb(k.a),h.Jb(r.eb),h.Jb(y.b))},M.\u0275cmp=h.Db({type:M,selectors:[["app-baskets"]],decls:14,vars:4,consts:[[3,"translucent"],["color","tertiary"],["slot","start"],["slot","end"],["fill","clear",3,"click"],["slot","icon-only","md","card-sharp","ios","card-outline"],["slot","icon-only","md","filter-sharp","ios","filter-outline"],["color","tertiary",4,"ngIf"],[4,"ngIf"],["color","tertiary","placeholder","Axtar",1,"ion-no-padding",3,"ngModel","ngModelChange","ionChange"],["slot","fixed",3,"ionRefresh"],["lines","full","color","light",4,"ngIf"],[4,"ngIf","ngIfElse"],["notBaskets",""],["lines","full","color","light"],["multiple","false","cancelText","Ba\u011fla","okText","T\u018fSD\u0130QL\u018f",3,"ngModel","ngModelChange","ionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["size-md","6","size","12",4,"ngFor","ngForOf"],["size-md","6","size","12"],["button","",3,"routerLink","color","lines"],[1,"ion-padding",3,"src"],[1,"ion-text-wrap"],["color","primary"],["color","secondary"],["side","end"],["color","secondary","expandable","",3,"click"],["slot","top","ios","link-outline","md","link-sharp"],["color","medium","expandable","",3,"click",4,"ngIf"],["color","tertiary","expandable","",3,"click"],["slot","top","ios","airplane-outline","md","airplane-sharp"],["color","medium","expandable","",3,"click"],["slot","top","ios","card-outline","md","card-sharp"],["color","alert"],[2,"height","100%"],[1,"ion-justify-content-center","ion-align-items-center",2,"height","100%"],[1,"ion-text-center",2,"display","flex","justify-content","center","align-items","center"],["src","../assets/img/loading.gif",2,"width","100px","height","100px"]],template:function(e,t){1&e&&(h.Pb(0,"ion-header",0),h.Pb(1,"ion-toolbar",1),h.Pb(2,"ion-buttons",2),h.Kb(3,"ion-menu-button"),h.Ob(),h.Pb(4,"ion-title"),h.vc(5,"S\u0259b\u0259tl\u0259r"),h.Ob(),h.Pb(6,"ion-buttons",3),h.Pb(7,"ion-button",4),h.Xb("click",(function(){return t.pay(t.baskets)})),h.Kb(8,"ion-icon",5),h.Ob(),h.Pb(9,"ion-button",4),h.Xb("click",(function(){return t.isFilterActive=!t.isFilterActive})),h.Kb(10,"ion-icon",6),h.Ob(),h.Ob(),h.Ob(),h.tc(11,v,2,1,"ion-toolbar",7),h.Ob(),h.tc(12,B,7,3,"ion-content",8),h.tc(13,S,5,0,"ion-content",8)),2&e&&(h.gc("translucent",!1),h.yb(11),h.gc("ngIf",t.isSearchActive),h.yb(1),h.gc("ngIf",!t.isLoading),h.yb(1),h.gc("ngIf",t.isLoading))},directives:[r.t,r.ab,r.h,r.F,r.Z,r.g,r.u,i.k,r.N,r.mb,o.f,o.i,r.p,r.J,r.K,r.x,r.B,r.Q,r.lb,r.R,i.j,r.s,r.M,r.o,r.A,r.kb,a.h,r.Y,r.v,r.W,r.z,r.y,r.i,r.j],pipes:[i.r],styles:["ion-thumbnail[_ngcontent-%COMP%]{--size:100px;height:100%}"]}),M)},{path:"basket-detail",loadChildren:function(){return n.e(0).then(n.bind(null,"Gr9e")).then((function(e){return e.BasketDetailPageModule}))}},{path:"add-basket",loadChildren:function(){return n.e(0).then(n.bind(null,"hL1b")).then((function(e){return e.AddBasketPageModule}))}}],F=((A=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:A}),A.\u0275inj=h.Gb({factory:function(e){return new(e||A)},imports:[[a.j.forChild(I)],a.j]}),A),K=((Z=function e(){_classCallCheck(this,e)}).\u0275mod=h.Hb({type:Z}),Z.\u0275inj=h.Gb({factory:function(e){return new(e||Z)},imports:[[i.b,o.a,r.bb,F]]}),Z)}}]);