function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{cwMR:function(e,n,t){"use strict";t.r(n),t.d(n,"PackagesPageModule",(function(){return N}));var i=t("ofXK"),a=t("3Pt+"),o=t("TEn/"),r=t("tyNb"),c=t("mrSG"),s=t("dvAk"),l=function(e){return e[e.Declarations=0]="Declarations",e[e.NotCompleted=1]="NotCompleted",e[e.ExternalStorage=2]="ExternalStorage",e[e.OnWay=3]="OnWay",e[e.CustomsClearance=4]="CustomsClearance",e[e.InternalStorage=5]="InternalStorage",e[e.Delivered=6]="Delivered",e}({}),u=t("F27V"),b=t("AxNX"),f=t("Mky/"),g=t("fXoL"),h=t("0Inu"),d=t("qfBg"),p=t("ndxW"),m=t("Nm8O"),v=t("Ymxs"),y=t("e8h1");function k(e,n){if(1&e){var t=g.Qb();g.Pb(0,"ion-toolbar",1),g.Pb(1,"ion-searchbar",9),g.Xb("ngModelChange",(function(e){return g.oc(t),g.Zb().keyword=e}))("ionChange",(function(){return g.oc(t),g.Zb().search()})),g.Ob(),g.Ob()}if(2&e){var i=g.Zb();g.yb(1),g.gc("ngModel",i.keyword)}}function P(e,n){if(1&e&&(g.Pb(0,"ion-select-option",16),g.Pb(1,"span"),g.vc(2),g.Ob(),g.Ob()),2&e){var t=n.$implicit,i=n.index,a=g.Zb(3);g.gc("value",i),g.yb(2),g.wc(a.stateService.getPackageStateInAzerbaijani(t))}}function O(e,n){if(1&e){var t=g.Qb();g.Pb(0,"ion-item",14),g.Pb(1,"ion-label"),g.vc(2,"Filtr"),g.Ob(),g.Pb(3,"ion-select",15),g.Xb("ngModelChange",(function(e){return g.oc(t),g.Zb(2).filterKey=e}))("ionChange",(function(){return g.oc(t),g.Zb(2).filterPackages()})),g.Pb(4,"ion-select-option",16),g.vc(5," Filtr se\xe7ilm\u0259yib "),g.Ob(),g.tc(6,P,3,2,"ion-select-option",17),g.ac(7,"slice"),g.Ob(),g.Ob()}if(2&e){var i=g.Zb(2);g.yb(3),g.gc("ngModel",i.filterKey),g.yb(1),g.gc("value","none"),g.yb(2),g.gc("ngForOf",g.cc(7,3,i.packageStateData,1))}}function x(e,n){1&e&&(g.Pb(0,"ion-text",31),g.Pb(1,"p"),g.vc(2,"\xd6d\u0259ni\u015f g\xf6zl\u0259nilir"),g.Ob(),g.Ob())}function C(e,n){1&e&&(g.Pb(0,"ion-text",32),g.Pb(1,"p"),g.vc(2,"\xd6d\u0259ni\u015f edilib"),g.Ob(),g.Ob())}function w(e,n){if(1&e){var t=g.Qb();g.Pb(0,"ion-item-option",33),g.Xb("click",(function(){g.oc(t);var e=g.Zb().$implicit;return g.Zb(3).pay([e])})),g.Kb(1,"ion-icon",34),g.Pb(2,"ion-label"),g.vc(3," \xd6d\u0259 "),g.Ob(),g.Ob()}}function S(e,n){if(1&e){var t=g.Qb();g.Pb(0,"ion-col",19),g.Pb(1,"ion-item-sliding"),g.Pb(2,"ion-item",20),g.Pb(3,"ion-thumbnail",2),g.Kb(4,"ion-img",21),g.Ob(),g.Pb(5,"ion-label",22),g.Pb(6,"ion-text",23),g.Pb(7,"h3"),g.vc(8),g.Ob(),g.Ob(),g.Pb(9,"ion-text",24),g.Pb(10,"p"),g.vc(11),g.Ob(),g.Ob(),g.tc(12,x,3,0,"ion-text",25),g.tc(13,C,3,0,"ion-text",26),g.Pb(14,"p"),g.Pb(15,"ion-text",23),g.vc(16),g.ac(17,"currency"),g.Ob(),g.Ob(),g.Ob(),g.Ob(),g.Pb(18,"ion-item-options",27),g.tc(19,w,4,0,"ion-item-option",28),g.Pb(20,"ion-item-option",29),g.Xb("click",(function(){g.oc(t);var e=n.$implicit;return g.Zb(3).presentTrackingModal(e)})),g.Kb(21,"ion-icon",30),g.Pb(22,"ion-label"),g.vc(23," \u0130zl\u0259 "),g.Ob(),g.Ob(),g.Ob(),g.Ob(),g.Ob()}if(2&e){var i=n.$implicit,a=n.index,o=g.Zb(3);g.yb(2),g.ic("routerLink","/dashboard/packages/package/",i.id,""),g.gc("color",o.platform.is("mobile")&&a%2!=0?"light":null)("lines",o.platform.is("mobile")?"none":null),g.yb(2),g.gc("src","/assets/img/package_thumbnail.png"),g.yb(4),g.wc(i.id),g.yb(3),g.xc(" ",o.stateService.getPackageStateInAzerbaijani(i.current_state.toString())," "),g.yb(1),g.gc("ngIf",!i.is_paid),g.yb(1),g.gc("ngIf",i.is_paid),g.yb(3),g.yc("",i.weight," kq | ",g.bc(17,11,i.amount),""),g.yb(3),g.gc("ngIf",!i.is_paid)}}function I(e,n){if(1&e&&(g.Pb(0,"ion-grid"),g.Pb(1,"ion-row"),g.tc(2,S,24,13,"ion-col",18),g.Ob(),g.Ob()),2&e){var t=g.Zb(2);g.yb(2),g.gc("ngForOf",t.packages)}}function M(e,n){1&e&&(g.Pb(0,"ion-card",35),g.Pb(1,"ion-card-content"),g.vc(2," He\xe7 bir ba\u011flama tap\u0131lmad\u0131. "),g.Ob(),g.Ob())}function _(e,n){if(1&e){var t=g.Qb();g.Pb(0,"ion-content"),g.Pb(1,"ion-refresher",10),g.Xb("ionRefresh",(function(){return g.oc(t),g.Zb().doRefresh()})),g.Kb(2,"ion-refresher-content"),g.Ob(),g.tc(3,O,8,6,"ion-item",11),g.tc(4,I,3,1,"ion-grid",12),g.tc(5,M,3,0,"ng-template",null,13,g.uc),g.Ob()}if(2&e){var i=g.mc(6),a=g.Zb();g.yb(3),g.gc("ngIf",a.isFilterActive),g.yb(1),g.gc("ngIf",a.packages.length>0)("ngIfElse",i)}}function A(e,n){1&e&&(g.Pb(0,"ion-content"),g.Pb(1,"ion-grid",36),g.Pb(2,"ion-row",37),g.Pb(3,"ion-col",38),g.Kb(4,"ion-img",39),g.Ob(),g.Ob(),g.Ob(),g.Ob())}var Z,F,j,z=[{path:"",component:(Z=function(){function e(n,t,i,a,o,r,c,s,l){_classCallCheck(this,e),this.packageService=n,this.platform=t,this.userService=i,this.stateService=a,this.alertCtrl=o,this.helper=r,this.toaster=c,this.modalController=s,this.storage=l,this.isFilterActive=!0,this.isSearchActive=!1,this.packages=[],this.isLoading=!1,this.filterKey="none",this.amount=0,this.user=new f.a}return _createClass(e,[{key:"ionViewWillEnter",value:function(){this.getPackages()}},{key:"ngOnInit",value:function(){}},{key:"presentTrackingModal",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:u.a,swipeToClose:!0,componentProps:{states:e.states}});case 2:return t=n.sent,n.next=5,t.present();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"showAlert",value:function(e){this.alertCtrl.create({header:"X\u0259ta a\u015fkarland\u0131",message:e,buttons:["Tamam"]}).then((function(e){return e.present()}))}},{key:"getPackages",value:function(){var e=this;this.storage.get("user").then((function(n){e.user=n,e.packages=n.packages}))}},{key:"filterPackages",value:function(){var e=this;this.isLoading=!0,this.storage.get("access_token").then((function(n){e.packageService.getPackages(e.user.id).subscribe((function(n){e.user.packages=n,e.storage.set("user",e.user).then((function(t){e.packages="none"!==e.filterKey?n.filter((function(n){return l[n.current_state.toString()]===Number(e.filterKey)})):n,e.isLoading=!1}))}),(function(n){e.isLoading=!1,404!==n.status&&e.showAlert("Bilinm\u0259y\u0259n bir x\u0259ta ba\u015f verdi. Z\u0259hm\u0259t olmasa, daha sonra t\u0259krar yoxlay\u0131n.")}))}))}},{key:"doRefresh",value:function(){this.filterPackages()}},{key:"search",value:function(){}},{key:"presentCheckoutModal",value:function(e,n){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:b.a,swipeToClose:!0,cssClass:"checkoutModal",componentProps:{amount:e,currency:n}});case 2:return i=t.sent,t.next=5,i.present();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"showConfirm",value:function(e,n){var t=this;this.alertCtrl.create({header:"\xd6d\u0259ni\u015f et",message:e,buttons:[{text:"L\u0259v\u011f et",role:"cancel"},{text:"Balans art\u0131r",handler:function(){t.presentCheckoutModal(t.amount,"USD").then((function(e){return console.log(e)}))}},{text:"Tamamla",handler:function(){t.completePayment(n)}}]}).then((function(e){return e.present()}))}},{key:"pay",value:function(e){var n=e.filter((function(e){return!e.is_paid}));this.getPackagesAmount(n),0!==this.amount?this.showConfirm("\n                            Hal-haz\u0131rk\u0131 balans: $".concat(this.user.wallet_usd.toFixed(2),"<br>\n                            Da\u015f\u0131nma haqq\u0131: $").concat(this.amount.toFixed(2),"<br>\n                            <hr>\n                            <small>Balans\u0131n\u0131zda kifay\u0259t q\u0259d\u0259r v\u0259sait yoxdursa, z\u0259hm\u0259t olmasa, balans art\u0131r d\xfcym\u0259sini s\u0131x\u0131n.</small>\n                        "),n):this.showAlert("Natamam \xf6d\u0259ni\u015fli ba\u011flama tap\u0131lmad\u0131.")}},{key:"getPackagesAmount",value:function(e){var n=this;this.amount=0,e.forEach((function(e){return n.amount+=e.amount}))}},{key:"completePayment",value:function(e){var n=this;this.packageService.setPackagesToPaid(e,this.amount,this.user.id).subscribe((function(e){"User's wallet is not enough for payment."===JSON.parse(e).message?n.toaster.danger("Balans\u0131n\u0131zda kifay\u0259t q\u0259d\u0259r v\u0259sait yoxdur."):(n.filterPackages(),n.toaster.success("\xd6d\u0259ni\u015finiz u\u011furla ba\u015fa \xe7atd\u0131."))}),(function(e){n.showAlert("Bilinm\u0259y\u0259n bir x\u0259ta ba\u015f verdi. Z\u0259hm\u0259t olmasa, daha sonra t\u0259krar yoxlay\u0131n.")}))}},{key:"productCategoryData",get:function(){return Object.keys(s.a).filter((function(e){return!isNaN(Number(s.a[e]))}))}},{key:"packageStateData",get:function(){return Object.keys(l).filter((function(e){return!isNaN(Number(l[e]))}))}}]),e}(),Z.\u0275fac=function(e){return new(e||Z)(g.Jb(h.a),g.Jb(o.hb),g.Jb(d.a),g.Jb(p.a),g.Jb(o.a),g.Jb(m.b),g.Jb(v.a),g.Jb(o.eb),g.Jb(y.b))},Z.\u0275cmp=g.Db({type:Z,selectors:[["app-packages"]],decls:14,vars:4,consts:[[3,"translucent"],["color","tertiary"],["slot","start"],["slot","end"],["fill","clear",3,"click"],["slot","icon-only","md","card-sharp","ios","card-outline"],["slot","icon-only","md","filter-sharp","ios","filter-outline"],["color","tertiary",4,"ngIf"],[4,"ngIf"],["color","tertiary","placeholder","Axtar",1,"ion-no-padding",3,"ngModel","ngModelChange","ionChange"],["slot","fixed",3,"ionRefresh"],["lines","full","color","light",4,"ngIf"],[4,"ngIf","ngIfElse"],["notPackages",""],["lines","full","color","light"],["multiple","false","cancelText","Ba\u011fla","okText","T\u018fSD\u0130QL\u018f",3,"ngModel","ngModelChange","ionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["size-md","6","size","12",4,"ngFor","ngForOf"],["size-md","6","size","12"],["button","",3,"routerLink","color","lines"],[1,"ion-padding",3,"src"],[1,"ion-text-wrap"],["color","primary"],["color","secondary"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["side","end"],["color","medium","expandable","",3,"click",4,"ngIf"],["color","tertiary","expandable","",3,"click"],["slot","top","ios","airplane-outline","md","airplane-sharp"],["color","danger"],["color","success"],["color","medium","expandable","",3,"click"],["slot","top","ios","card-outline","md","card-sharp"],["color","alert"],[2,"height","100%"],[1,"ion-justify-content-center","ion-align-items-center",2,"height","100%"],[1,"ion-text-center",2,"display","flex","justify-content","center","align-items","center"],["src","../assets/img/loading.gif",2,"width","100px","height","100px"]],template:function(e,n){1&e&&(g.Pb(0,"ion-header",0),g.Pb(1,"ion-toolbar",1),g.Pb(2,"ion-buttons",2),g.Kb(3,"ion-menu-button"),g.Ob(),g.Pb(4,"ion-title"),g.vc(5,"Ba\u011flamalar"),g.Ob(),g.Pb(6,"ion-buttons",3),g.Pb(7,"ion-button",4),g.Xb("click",(function(){return n.pay(n.packages)})),g.Kb(8,"ion-icon",5),g.Ob(),g.Pb(9,"ion-button",4),g.Xb("click",(function(){return n.isFilterActive=!n.isFilterActive})),g.Kb(10,"ion-icon",6),g.Ob(),g.Ob(),g.Ob(),g.tc(11,k,2,1,"ion-toolbar",7),g.Ob(),g.tc(12,_,7,3,"ion-content",8),g.tc(13,A,5,0,"ion-content",8)),2&e&&(g.gc("translucent",!1),g.yb(11),g.gc("ngIf",n.isSearchActive),g.yb(1),g.gc("ngIf",!n.isLoading),g.yb(1),g.gc("ngIf",n.isLoading))},directives:[o.t,o.ab,o.h,o.F,o.Z,o.g,o.u,i.k,o.N,o.mb,a.f,a.i,o.p,o.J,o.K,o.x,o.B,o.Q,o.lb,o.R,i.j,o.s,o.M,o.o,o.A,o.kb,r.h,o.Y,o.v,o.W,o.z,o.y,o.i,o.j],pipes:[i.r,i.c],styles:["ion-thumbnail[_ngcontent-%COMP%]{--size:100px;height:100%}"]}),Z)},{path:"express-service",loadChildren:function(){return t.e(0).then(t.bind(null,"D8gZ")).then((function(e){return e.ExpressServicePageModule}))}},{path:"postal-service",loadChildren:function(){return t.e(0).then(t.bind(null,"uD0H")).then((function(e){return e.PostalServicePageModule}))}},{path:"courier-service",loadChildren:function(){return t.e(0).then(t.bind(null,"drLq")).then((function(e){return e.CourierServicePageModule}))}}],K=((j=function e(){_classCallCheck(this,e)}).\u0275mod=g.Hb({type:j}),j.\u0275inj=g.Gb({factory:function(e){return new(e||j)},imports:[[r.j.forChild(z)],r.j]}),j),N=((F=function e(){_classCallCheck(this,e)}).\u0275mod=g.Hb({type:F}),F.\u0275inj=g.Gb({factory:function(e){return new(e||F)},imports:[[i.b,a.a,o.bb,K]]}),F)}}]);