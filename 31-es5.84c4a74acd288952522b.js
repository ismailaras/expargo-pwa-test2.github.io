function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{DXzT:function(e,n,t){"use strict";t.r(n),t.d(n,"OrdersPageModule",(function(){return A}));var i=t("ofXK"),r=t("3Pt+"),o=t("TEn/"),a=t("tyNb"),s=t("mrSG"),c=t("y+FX"),l=t("GaRv"),b=t("Mky/"),u=t("AxNX"),d=t("fXoL"),f=t("kVqo"),h=t("ndxW"),g=t("qfBg"),m=t("Ymxs"),p=t("Nm8O"),v=t("e8h1");function y(e,n){if(1&e){var t=d.Qb();d.Pb(0,"ion-toolbar",1),d.Pb(1,"ion-searchbar",9),d.Xb("ngModelChange",(function(e){return d.oc(t),d.Zb().keyword=e}))("ionChange",(function(){return d.oc(t),d.Zb().search()})),d.Ob(),d.Ob()}if(2&e){var i=d.Zb();d.zb(1),d.gc("ngModel",i.keyword)}}function O(e,n){if(1&e&&(d.Pb(0,"ion-select-option",16),d.uc(1),d.Ob()),2&e){var t=n.$implicit,i=n.index,r=d.Zb(3);d.gc("value",i),d.zb(1),d.wc(" ",r.stateService.getOrderStateInAzerbaijani(t)," ")}}function k(e,n){if(1&e){var t=d.Qb();d.Pb(0,"ion-item",14),d.Pb(1,"ion-label"),d.uc(2,"Filtr"),d.Ob(),d.Pb(3,"ion-select",15),d.Xb("ngModelChange",(function(e){return d.oc(t),d.Zb(2).filterKey=e}))("ionChange",(function(){return d.oc(t),d.Zb(2).filterOrders()})),d.Pb(4,"ion-select-option",16),d.uc(5," Filtr se\xe7ilm\u0259yib "),d.Ob(),d.sc(6,O,2,2,"ion-select-option",17),d.ac(7,"slice"),d.Ob(),d.Ob()}if(2&e){var i=d.Zb(2);d.zb(3),d.gc("ngModel",i.filterKey),d.zb(1),d.gc("value","none"),d.zb(2),d.gc("ngForOf",d.cc(7,3,i.orderStateData,0))}}function P(e,n){if(1&e){var t=d.Qb();d.Pb(0,"ion-item-option",31),d.Xb("click",(function(){d.oc(t);var e=d.Zb().$implicit;return d.Zb(3).pay([e])})),d.Kb(1,"ion-icon",32),d.Pb(2,"ion-label"),d.uc(3," \xd6d\u0259 "),d.Ob(),d.Ob()}}function x(e,n){if(1&e){var t=d.Qb();d.Pb(0,"ion-col",19),d.Pb(1,"ion-item-sliding"),d.Pb(2,"ion-item",20),d.Pb(3,"ion-thumbnail",2),d.Kb(4,"ion-img",21),d.Ob(),d.Pb(5,"ion-label",22),d.Pb(6,"ion-text",23),d.Pb(7,"h3"),d.uc(8),d.Ob(),d.Ob(),d.Pb(9,"ion-text",24),d.Pb(10,"p"),d.uc(11),d.Ob(),d.Ob(),d.Ob(),d.Ob(),d.Pb(12,"ion-item-options",25),d.Pb(13,"ion-item-option",26),d.Xb("click",(function(){d.oc(t);var e=n.$implicit;return d.Zb(3).goUrl(e)})),d.Kb(14,"ion-icon",27),d.Pb(15,"ion-label"),d.uc(16," URL "),d.Ob(),d.Ob(),d.sc(17,P,4,0,"ion-item-option",28),d.Pb(18,"ion-item-option",29),d.Xb("click",(function(){d.oc(t);var e=n.$implicit;return d.Zb(3).presentTrackingModal(e)})),d.Kb(19,"ion-icon",30),d.Pb(20,"ion-label"),d.uc(21," \u0130zl\u0259 "),d.Ob(),d.Ob(),d.Ob(),d.Ob(),d.Ob()}if(2&e){var i=n.$implicit,r=n.index,o=d.Zb(3);d.zb(2),d.ic("routerLink","/dashboard/orders/order/",i.id,""),d.gc("color",o.platform.is("mobile")&&r%2!=0?"light":null)("lines",o.platform.is("mobile")?"none":null),d.zb(2),d.gc("src","/assets/img/orders_thumbnail.png"),d.zb(4),d.vc(i.id),d.zb(3),d.wc(" ",o.stateService.getOrderStateInAzerbaijani(i.current_state.toString())," "),d.zb(6),d.gc("ngIf","Incomplete"===i.current_state.toString())}}function w(e,n){if(1&e&&(d.Pb(0,"ion-grid"),d.Pb(1,"ion-row"),d.sc(2,x,22,7,"ion-col",18),d.Ob(),d.Ob()),2&e){var t=d.Zb(2);d.zb(2),d.gc("ngForOf",t.orders)}}function C(e,n){1&e&&(d.Pb(0,"ion-card",1),d.Pb(1,"ion-card-content"),d.uc(2," He\xe7 bir sifari\u015f tap\u0131lmad\u0131. "),d.Ob(),d.Ob())}function z(e,n){if(1&e){var t=d.Qb();d.Pb(0,"ion-content"),d.Pb(1,"ion-refresher",10),d.Xb("ionRefresh",(function(){return d.oc(t),d.Zb().doRefresh()})),d.Kb(2,"ion-refresher-content"),d.Ob(),d.sc(3,k,8,6,"ion-item",11),d.sc(4,w,3,1,"ion-grid",12),d.sc(5,C,3,0,"ng-template",null,13,d.tc),d.Ob()}if(2&e){var i=d.mc(6),r=d.Zb();d.zb(3),d.gc("ngIf",r.isFilterActive),d.zb(1),d.gc("ngIf",r.orders.length>0)("ngIfElse",i)}}function _(e,n){1&e&&(d.Pb(0,"ion-content"),d.Pb(1,"ion-grid",33),d.Pb(2,"ion-row",34),d.Pb(3,"ion-col",35),d.Kb(4,"ion-spinner",23),d.Ob(),d.Ob(),d.Ob(),d.Ob())}var S,M,Z,F=[{path:"",component:(S=function(){function e(n,t,i,r,o,a,s,c,l){_classCallCheck(this,e),this.orderService=n,this.platform=t,this.stateService=i,this.alertCtrl=r,this.userService=o,this.toaster=a,this.helper=s,this.modalController=c,this.storage=l,this.isFilterActive=!0,this.isSearchActive=!1,this.orders=[],this.isLoading=!1,this.filterKey="none",this.user=new b.a,this.missing_fee=0}return _createClass(e,[{key:"ionViewWillEnter",value:function(){this.filterOrders()}},{key:"ngOnInit",value:function(){}},{key:"showAlert",value:function(e){this.alertCtrl.create({header:"X\u0259ta a\u015fkarland\u0131",message:e,buttons:["Tamam"]}).then((function(e){return e.present()}))}},{key:"filterOrders",value:function(){var e=this;this.isLoading=!0,this.storage.get("access_token").then((function(n){e.orderService.getOrders(e.helper.decodeToken(n).identity).subscribe((function(n){e.orders="none"!==e.filterKey?n.filter((function(n){return c.a[n.current_state.toString()]===Number(e.filterKey)})):n,e.isLoading=!1}),(function(n){e.isLoading=!1,404!==n.status&&e.showAlert("Bilinm\u0259y\u0259n bir x\u0259ta ba\u015f verdi. Z\u0259hm\u0259t olmasa, daha sonra t\u0259krar yoxlay\u0131n.")}))}))}},{key:"doRefresh",value:function(){this.filterOrders()}},{key:"search",value:function(){}},{key:"presentTrackingModal",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:l.a,swipeToClose:!0,componentProps:{states:e.states}});case 2:return t=n.sent,n.next=5,t.present();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"goUrl",value:function(e){window.open(e.url,"_blank")}},{key:"presentCheckoutModal",value:function(e,n){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:u.a,swipeToClose:!0,cssClass:"checkoutModal",componentProps:{amount:e,currency:n}});case 2:return i=t.sent,t.next=5,i.present();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"showConfirm",value:function(e,n){var t=this;this.alertCtrl.create({header:"\xd6d\u0259ni\u015f et",message:e,buttons:[{text:"L\u0259v\u011f et",role:"cancel"},{text:"Balans art\u0131r",handler:function(){t.presentCheckoutModal(t.missing_fee,"TRY").then((function(e){return console.log(e)}))}},{text:"Tamamla",handler:function(){t.completePayment(n)}}]}).then((function(e){return e.present()}))}},{key:"pay",value:function(e){var n=this;this.isLoading=!0,this.storage.get("access_token").then((function(t){n.userService.getDetail(n.helper.decodeToken(t).identity).subscribe((function(t){n.isLoading=!1,n.user=t;var i=e.filter((function(e){return"Incomplete"===e.current_state.toString()}));n.getOrdersMissingFee(i),0!==n.missing_fee?n.showConfirm("\n                    Hal-haz\u0131rk\u0131 balans: \u20ba".concat(n.user.wallet_try.toFixed(2),"<br>\n                    Natamam m\u0259bl\u0259\u011f: \u20ba").concat(n.missing_fee.toFixed(2),"<br>\n                    <hr>\n                    <small>Balans\u0131n\u0131zda kifay\u0259t q\u0259d\u0259r v\u0259sait yoxdursa, z\u0259hm\u0259t olmasa, balans art\u0131r d\xfcym\u0259sini s\u0131x\u0131n.</small>\n                "),i):n.showAlert("Natamam \xf6d\u0259ni\u015fli sifari\u015f tap\u0131lmad\u0131.")}),(function(e){n.isLoading=!1,n.showAlert("Bilinm\u0259y\u0259n bir x\u0259ta ba\u015f verdi. Z\u0259hm\u0259t olmasa, daha sonra t\u0259krar yoxlay\u0131n.")}))}))}},{key:"getOrdersMissingFee",value:function(e){var n=this;this.missing_fee=0,e.forEach((function(e){return n.missing_fee+=e.missing_fee}))}},{key:"completePayment",value:function(e){var n=this;this.orderService.setOrdersToReadyToOrder(e,this.missing_fee,this.user.id).subscribe((function(e){"User's wallet is not enough for payment."===JSON.parse(e).message?n.toaster.danger("Balans\u0131n\u0131zda kifay\u0259t q\u0259d\u0259r v\u0259sait yoxdur."):(n.filterOrders(),n.toaster.success("\xd6d\u0259ni\u015finiz u\u011furla ba\u015fa \xe7atd\u0131."))}),(function(e){n.showAlert("Bilinm\u0259y\u0259n bir x\u0259ta ba\u015f verdi. Z\u0259hm\u0259t olmasa, daha sonra t\u0259krar yoxlay\u0131n.")}))}},{key:"orderStateData",get:function(){return Object.keys(c.a).filter((function(e){return!isNaN(Number(c.a[e]))}))}}]),e}(),S.\u0275fac=function(e){return new(e||S)(d.Jb(f.a),d.Jb(o.ib),d.Jb(h.a),d.Jb(o.a),d.Jb(g.a),d.Jb(m.a),d.Jb(p.b),d.Jb(o.fb),d.Jb(v.b))},S.\u0275cmp=d.Db({type:S,selectors:[["app-orders"]],decls:14,vars:4,consts:[[3,"translucent"],["color","tertiary"],["slot","start"],["slot","end"],["fill","clear",3,"click"],["slot","icon-only","md","card-sharp","ios","card-outline"],["slot","icon-only","md","filter-sharp","ios","filter-outline"],["color","tertiary",4,"ngIf"],[4,"ngIf"],["color","tertiary","placeholder","Axtar",1,"ion-no-padding",3,"ngModel","ngModelChange","ionChange"],["slot","fixed",3,"ionRefresh"],["lines","full","color","light",4,"ngIf"],[4,"ngIf","ngIfElse"],["notOrders",""],["lines","full","color","light"],["multiple","false","cancelText","Ba\u011fla","okText","T\u018fSD\u0130QL\u018f",3,"ngModel","ngModelChange","ionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["size-md","6","size","12",4,"ngFor","ngForOf"],["size-md","6","size","12"],["button","",3,"routerLink","color","lines"],[1,"ion-padding",3,"src"],[1,"ion-text-wrap"],["color","primary"],["color","secondary"],["side","end"],["color","secondary","expandable","",3,"click"],["slot","top","ios","link-outline","md","link-sharp"],["color","medium","expandable","",3,"click",4,"ngIf"],["color","tertiary","expandable","",3,"click"],["slot","top","ios","airplane-outline","md","airplane-sharp"],["color","medium","expandable","",3,"click"],["slot","top","ios","card-outline","md","card-sharp"],[2,"height","100%"],[1,"ion-justify-content-center","ion-align-items-center",2,"height","100%"],[1,"ion-text-center"]],template:function(e,n){1&e&&(d.Pb(0,"ion-header",0),d.Pb(1,"ion-toolbar",1),d.Pb(2,"ion-buttons",2),d.Kb(3,"ion-menu-button"),d.Ob(),d.Pb(4,"ion-title"),d.uc(5,"Sifari\u015fl\u0259r"),d.Ob(),d.Pb(6,"ion-buttons",3),d.Pb(7,"ion-button",4),d.Xb("click",(function(){return n.pay(n.orders)})),d.Kb(8,"ion-icon",5),d.Ob(),d.Pb(9,"ion-button",4),d.Xb("click",(function(){return n.isFilterActive=!n.isFilterActive})),d.Kb(10,"ion-icon",6),d.Ob(),d.Ob(),d.Ob(),d.sc(11,y,2,1,"ion-toolbar",7),d.Ob(),d.sc(12,z,7,3,"ion-content",8),d.sc(13,_,5,0,"ion-content",8)),2&e&&(d.gc("translucent",!1),d.zb(11),d.gc("ngIf",n.isSearchActive),d.zb(1),d.gc("ngIf",!n.isLoading),d.zb(1),d.gc("ngIf",n.isLoading))},directives:[o.t,o.bb,o.h,o.F,o.ab,o.g,o.u,i.k,o.O,o.nb,r.f,r.i,o.p,o.K,o.L,o.x,o.B,o.R,o.mb,o.S,i.j,o.s,o.N,o.o,o.A,o.lb,a.h,o.Z,o.v,o.Y,o.z,o.y,o.i,o.j,o.W],pipes:[i.r],styles:["ion-thumbnail[_ngcontent-%COMP%]{--size:100px}"]}),S)},{path:"order-detail",loadChildren:function(){return t.e(6).then(t.bind(null,"arML")).then((function(e){return e.OrderDetailPageModule}))}},{path:"add-order",loadChildren:function(){return Promise.all([t.e(0),t.e(26)]).then(t.bind(null,"+JV4")).then((function(e){return e.AddOrderPageModule}))}}],I=((Z=function e(){_classCallCheck(this,e)}).\u0275mod=d.Hb({type:Z}),Z.\u0275inj=d.Gb({factory:function(e){return new(e||Z)},imports:[[a.j.forChild(F)],a.j]}),Z),A=((M=function e(){_classCallCheck(this,e)}).\u0275mod=d.Hb({type:M}),M.\u0275inj=d.Gb({factory:function(e){return new(e||M)},imports:[[i.b,r.a,o.cb,I]]}),M)}}]);